<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../stylesheets/style.css">
</head>
<body>

    <div class="container">

        <div>





        </div>








    </div>

    <script>
        
        async function loadIngressoIds() {
            const response = await fetch('http://127.0.0.1:5000/api/clientes');
            const ingressos = await response.json();
            const ingressoSelect = document.getElementById('ingressoId');
            ingressos.forEach(ingresso => {
                const option = document.createElement('option');
                option.value = ingresso.id;
                option.text = `Ingresso ${ingresso.id} - ${ingresso.tipo}`;
                ingressoSelect.appendChild(option);
            });
        }


        async function handleSubmit(event) {
    event.preventDefault();
    const form = document.getElementById('ticketForm');
    const formData = new FormData(form);

    // Converte os dados do formul√°rio para um objeto JSON
    const data = Object.fromEntries(formData.entries());

    // Converte os campos de IDs para inteiros
    data.ingressoId = parseInt(data.ingressoId, 10);
    data.clienteId = parseInt(data.clienteId, 10);

    // Converte o valorPago para float
    data.valorPago = parseFloat(data.valorPago);

    // Converte ingressoUsado para BigInt
    data.ingressoUsado = BigInt(data.ingressoUsado).toString();

    // Envia os dados para o servidor
    const response = await fetch('http://127.0.0.1:5000/api/pedidos', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    });

    if (response.ok) {
        const result = await response.json();
        // Define o campo ID com a resposta do servidor
     
        // Salva a data e hora da compra no armazenamento local
        const currentDateTime = new Date().toISOString();
        localStorage.setItem('purchaseDateTime', currentDateTime);
        // Redireciona para code.html
        window.location.href = 'code.html';
    } else {
        console.error('Erro ao enviar dados:', response.statusText);
    }
}

    </script>
    <script src="../javascripts/script.js"></script>
</body>
</html>